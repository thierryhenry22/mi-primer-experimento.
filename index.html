<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neural Rider - Extreme Snow</title>
    <style>
        body { margin: 0; overflow: hidden; background: #000; font-family: sans-serif; }
        #ui { 
            position: absolute; top: 20px; width: 100%; text-align: center; 
            color: #00f2ff; font-size: 2.5rem; font-weight: bold;
            text-shadow: 0 0 15px #00f2ff; pointer-events: none; z-index: 10;
        }
    </style>
</head>
<body>

    <div id="ui">VELOCIDAD: <span id="speed">0</span> KM/H</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // 1. Escena y Motor
        const scene = new THREE.Scene();
        scene.background = new THREE.Color(0x0a0a0c);
        scene.fog = new THREE.Fog(0x0a0a0c, 10, 80);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        document.body.appendChild(renderer.domElement);

        // 2. Luces (Aseguran que nada se vea negro)
        const light = new THREE.AmbientLight(0xffffff, 0.7);
        scene.add(light);
        const directional = new THREE.DirectionalLight(0xffffff, 0.5);
        directional.position.set(5, 10, 5);
        scene.add(directional);

        // 3. Carretera
        const roadGeo = new THREE.BoxGeometry(12, 0.1, 1000);
        const roadMat = new THREE.MeshPhongMaterial({ color: 0x1a1a1a });
        const road = new THREE.Mesh(roadGeo, roadMat);
        scene.add(road);

        // Línea central
        const lineGeo = new THREE.PlaneGeometry(0.3, 1000);
        const lineMat = new THREE.MeshBasicMaterial({ color: 0xffffff });
        const line = new THREE.Mesh(lineGeo, lineMat);
        line.rotation.x = -Math.PI / 2;
        line.position.y = 0.1;
        scene.add(line);

        // 4. Nieve Lateral (Sólida, sin cuadriculado)
        const snowGeo = new THREE.PlaneGeometry(100, 1000);
        const snowMat = new THREE.MeshPhongMaterial({ color: 0xe0e0e0 });
        
        const snowL = new THREE.Mesh(snowGeo, snowMat);
        snowL.rotation.x = -Math.PI / 2;
        snowL.position.set(-56, -0.05, 0);
        scene.add(snowL);

        const snowR = snowL.clone();
        snowR.position.x = 56;
        scene.add(snowR);

        // 5. Árboles con Nieve
        const trees = [];
        function addTree(z) {
            const group = new THREE.Group();
            const trunk = new THREE.Mesh(new THREE.CylinderGeometry(0.2, 0.2, 1.5), new THREE.MeshPhongMaterial({color: 0x3d2b1f}));
            const leaves = new THREE.Mesh(new THREE.ConeGeometry(1.5, 4, 6), new THREE.MeshPhongMaterial({color: 0xffffff}));
            leaves.position.y = 2.5;
            group.add(trunk);
            group.add(leaves);
            group.position.set(Math.random() > 0.5 ? 10 : -10, 0, z);
            scene.add(group);
            trees.push(group);
        }
        for(let i = 0; i > -300; i -= 20) addTree(i);

        // 6. La Moto (Diseño Pro)
        const bike = new THREE.Group();
        const body = new THREE.Mesh(new THREE.BoxGeometry(0.7, 0.6, 2.2), new THREE.MeshPhongMaterial({color: 0x000000}));
        const glow = new THREE.Mesh(new THREE.BoxGeometry(0.75, 0.1, 1.8), new THREE.MeshBasicMaterial({color: 0x00f2ff}));
        glow.position.y = 0.2;
        bike.add(body, glow);
        scene.add(bike);
        bike.position.y = 0.6;

        camera.position.set(0, 4, 8);

        // 7. Controles
        let keys = {};
        window.onkeydown = (e) => keys[e.key] = true;
        window.onkeyup = (e) => keys[e.key] = false;

        let vel = 0;

        function animate() {
            requestAnimationFrame(animate);

            if(keys["ArrowUp"]) vel += 0.01;
            else vel *= 0.96;
            if(vel > 1) vel = 1;

            if(keys["ArrowLeft"] && bike.position.x > -5) bike.position.x -= 0.15;
            if(keys["ArrowRight"] && bike.position.x < 5) bike.position.x += 0.15;

            // Movimiento del mundo
            const moveStep = vel * 60;
            road.position.z += moveStep;
            line.position.z += moveStep;
            snowL.position.z += moveStep;
            snowR.position.z += moveStep;

            if(road.position.z > 200) {
                road.position.z = 0;
                line.position.z = 0;
                snowL.position.z = 0;
                snowR.position.z = 0;
            }

            trees.forEach(t => {
                t.position.z += moveStep;
                if(t.position.z > 20) t.position.z = -280;
            });

            // Cámara sigue a la moto
            camera.position.x += (bike.position.x - camera.position.x) * 0.1;
            camera.lookAt(bike.position.x, 1, -10);

            document.getElementById('speed').innerText = Math.floor(vel * 280);
            renderer.render(scene, camera);
        }

        window.onresize = () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        };

        animate();
    </script>
</body>
</html>
